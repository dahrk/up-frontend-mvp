{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction isTLSSocket(socket) {\n  return socket.encrypted;\n}\n\nconst deferToConnect = (socket, fn) => {\n  let listeners;\n\n  if (typeof fn === 'function') {\n    const connect = fn;\n    listeners = {\n      connect\n    };\n  } else {\n    listeners = fn;\n  }\n\n  const hasConnectListener = typeof listeners.connect === 'function';\n  const hasSecureConnectListener = typeof listeners.secureConnect === 'function';\n  const hasCloseListener = typeof listeners.close === 'function';\n\n  const onConnect = () => {\n    if (hasConnectListener) {\n      listeners.connect();\n    }\n\n    if (isTLSSocket(socket) && hasSecureConnectListener) {\n      if (socket.authorized) {\n        listeners.secureConnect();\n      } else if (!socket.authorizationError) {\n        socket.once('secureConnect', listeners.secureConnect);\n      }\n    }\n\n    if (hasCloseListener) {\n      socket.once('close', listeners.close);\n    }\n  };\n\n  if (socket.writable && !socket.connecting) {\n    onConnect();\n  } else if (socket.connecting) {\n    socket.once('connect', onConnect);\n  } else if (socket.destroyed && hasCloseListener) {\n    listeners.close(socket._hadError);\n  }\n};\n\nexports.default = deferToConnect; // For CommonJS default export support\n\nmodule.exports = deferToConnect;\nmodule.exports.default = deferToConnect;","map":{"version":3,"sources":["/home/td/code/up-frontend-mvp/node_modules/defer-to-connect/dist/source/index.js"],"names":["Object","defineProperty","exports","value","isTLSSocket","socket","encrypted","deferToConnect","fn","listeners","connect","hasConnectListener","hasSecureConnectListener","secureConnect","hasCloseListener","close","onConnect","authorized","authorizationError","once","writable","connecting","destroyed","_hadError","default","module"],"mappings":"AAAA;;AACAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;;AACA,SAASC,WAAT,CAAqBC,MAArB,EAA6B;AACzB,SAAOA,MAAM,CAACC,SAAd;AACH;;AACD,MAAMC,cAAc,GAAG,CAACF,MAAD,EAASG,EAAT,KAAgB;AACnC,MAAIC,SAAJ;;AACA,MAAI,OAAOD,EAAP,KAAc,UAAlB,EAA8B;AAC1B,UAAME,OAAO,GAAGF,EAAhB;AACAC,IAAAA,SAAS,GAAG;AAAEC,MAAAA;AAAF,KAAZ;AACH,GAHD,MAIK;AACDD,IAAAA,SAAS,GAAGD,EAAZ;AACH;;AACD,QAAMG,kBAAkB,GAAG,OAAOF,SAAS,CAACC,OAAjB,KAA6B,UAAxD;AACA,QAAME,wBAAwB,GAAG,OAAOH,SAAS,CAACI,aAAjB,KAAmC,UAApE;AACA,QAAMC,gBAAgB,GAAG,OAAOL,SAAS,CAACM,KAAjB,KAA2B,UAApD;;AACA,QAAMC,SAAS,GAAG,MAAM;AACpB,QAAIL,kBAAJ,EAAwB;AACpBF,MAAAA,SAAS,CAACC,OAAV;AACH;;AACD,QAAIN,WAAW,CAACC,MAAD,CAAX,IAAuBO,wBAA3B,EAAqD;AACjD,UAAIP,MAAM,CAACY,UAAX,EAAuB;AACnBR,QAAAA,SAAS,CAACI,aAAV;AACH,OAFD,MAGK,IAAI,CAACR,MAAM,CAACa,kBAAZ,EAAgC;AACjCb,QAAAA,MAAM,CAACc,IAAP,CAAY,eAAZ,EAA6BV,SAAS,CAACI,aAAvC;AACH;AACJ;;AACD,QAAIC,gBAAJ,EAAsB;AAClBT,MAAAA,MAAM,CAACc,IAAP,CAAY,OAAZ,EAAqBV,SAAS,CAACM,KAA/B;AACH;AACJ,GAfD;;AAgBA,MAAIV,MAAM,CAACe,QAAP,IAAmB,CAACf,MAAM,CAACgB,UAA/B,EAA2C;AACvCL,IAAAA,SAAS;AACZ,GAFD,MAGK,IAAIX,MAAM,CAACgB,UAAX,EAAuB;AACxBhB,IAAAA,MAAM,CAACc,IAAP,CAAY,SAAZ,EAAuBH,SAAvB;AACH,GAFI,MAGA,IAAIX,MAAM,CAACiB,SAAP,IAAoBR,gBAAxB,EAA0C;AAC3CL,IAAAA,SAAS,CAACM,KAAV,CAAgBV,MAAM,CAACkB,SAAvB;AACH;AACJ,CArCD;;AAsCArB,OAAO,CAACsB,OAAR,GAAkBjB,cAAlB,C,CACA;;AACAkB,MAAM,CAACvB,OAAP,GAAiBK,cAAjB;AACAkB,MAAM,CAACvB,OAAP,CAAesB,OAAf,GAAyBjB,cAAzB","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction isTLSSocket(socket) {\n    return socket.encrypted;\n}\nconst deferToConnect = (socket, fn) => {\n    let listeners;\n    if (typeof fn === 'function') {\n        const connect = fn;\n        listeners = { connect };\n    }\n    else {\n        listeners = fn;\n    }\n    const hasConnectListener = typeof listeners.connect === 'function';\n    const hasSecureConnectListener = typeof listeners.secureConnect === 'function';\n    const hasCloseListener = typeof listeners.close === 'function';\n    const onConnect = () => {\n        if (hasConnectListener) {\n            listeners.connect();\n        }\n        if (isTLSSocket(socket) && hasSecureConnectListener) {\n            if (socket.authorized) {\n                listeners.secureConnect();\n            }\n            else if (!socket.authorizationError) {\n                socket.once('secureConnect', listeners.secureConnect);\n            }\n        }\n        if (hasCloseListener) {\n            socket.once('close', listeners.close);\n        }\n    };\n    if (socket.writable && !socket.connecting) {\n        onConnect();\n    }\n    else if (socket.connecting) {\n        socket.once('connect', onConnect);\n    }\n    else if (socket.destroyed && hasCloseListener) {\n        listeners.close(socket._hadError);\n    }\n};\nexports.default = deferToConnect;\n// For CommonJS default export support\nmodule.exports = deferToConnect;\nmodule.exports.default = deferToConnect;\n"]},"metadata":{},"sourceType":"script"}