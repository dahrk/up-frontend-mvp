{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __exportStar = this && this.__exportStar || function (m, exports) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.defaultHandler = void 0;\n\nconst is_1 = require(\"@sindresorhus/is\");\n\nconst as_promise_1 = require(\"./as-promise\");\n\nconst create_rejection_1 = require(\"./as-promise/create-rejection\");\n\nconst core_1 = require(\"./core\");\n\nconst deep_freeze_1 = require(\"./utils/deep-freeze\");\n\nconst errors = {\n  RequestError: as_promise_1.RequestError,\n  CacheError: as_promise_1.CacheError,\n  ReadError: as_promise_1.ReadError,\n  HTTPError: as_promise_1.HTTPError,\n  MaxRedirectsError: as_promise_1.MaxRedirectsError,\n  TimeoutError: as_promise_1.TimeoutError,\n  ParseError: as_promise_1.ParseError,\n  CancelError: as_promise_1.CancelError,\n  UnsupportedProtocolError: as_promise_1.UnsupportedProtocolError,\n  UploadError: as_promise_1.UploadError\n}; // The `delay` package weighs 10KB (!)\n\nconst delay = async ms => new Promise(resolve => {\n  setTimeout(resolve, ms);\n});\n\nconst {\n  normalizeArguments\n} = core_1.default;\n\nconst mergeOptions = (...sources) => {\n  let mergedOptions;\n\n  for (const source of sources) {\n    mergedOptions = normalizeArguments(undefined, source, mergedOptions);\n  }\n\n  return mergedOptions;\n};\n\nconst getPromiseOrStream = options => options.isStream ? new core_1.default(undefined, options) : as_promise_1.default(options);\n\nconst isGotInstance = value => 'defaults' in value && 'options' in value.defaults;\n\nconst aliases = ['get', 'post', 'put', 'patch', 'head', 'delete'];\n\nexports.defaultHandler = (options, next) => next(options);\n\nconst callInitHooks = (hooks, options) => {\n  if (hooks) {\n    for (const hook of hooks) {\n      hook(options);\n    }\n  }\n};\n\nconst create = defaults => {\n  // Proxy properties from next handlers\n  defaults._rawHandlers = defaults.handlers;\n  defaults.handlers = defaults.handlers.map(fn => (options, next) => {\n    // This will be assigned by assigning result\n    let root;\n    const result = fn(options, newOptions => {\n      root = next(newOptions);\n      return root;\n    });\n\n    if (result !== root && !options.isStream && root) {\n      const typedResult = result;\n      const {\n        then: promiseThen,\n        catch: promiseCatch,\n        finally: promiseFianlly\n      } = typedResult;\n      Object.setPrototypeOf(typedResult, Object.getPrototypeOf(root));\n      Object.defineProperties(typedResult, Object.getOwnPropertyDescriptors(root)); // These should point to the new promise\n      // eslint-disable-next-line promise/prefer-await-to-then\n\n      typedResult.then = promiseThen;\n      typedResult.catch = promiseCatch;\n      typedResult.finally = promiseFianlly;\n    }\n\n    return result;\n  }); // Got interface\n\n  const got = (url, options = {}, _defaults) => {\n    var _a, _b;\n\n    let iteration = 0;\n\n    const iterateHandlers = newOptions => {\n      return defaults.handlers[iteration++](newOptions, iteration === defaults.handlers.length ? getPromiseOrStream : iterateHandlers);\n    }; // TODO: Remove this in Got 12.\n\n\n    if (is_1.default.plainObject(url)) {\n      const mergedOptions = { ...url,\n        ...options\n      };\n      core_1.setNonEnumerableProperties([url, options], mergedOptions);\n      options = mergedOptions;\n      url = undefined;\n    }\n\n    try {\n      // Call `init` hooks\n      let initHookError;\n\n      try {\n        callInitHooks(defaults.options.hooks.init, options);\n        callInitHooks((_a = options.hooks) === null || _a === void 0 ? void 0 : _a.init, options);\n      } catch (error) {\n        initHookError = error;\n      } // Normalize options & call handlers\n\n\n      const normalizedOptions = normalizeArguments(url, options, _defaults !== null && _defaults !== void 0 ? _defaults : defaults.options);\n      normalizedOptions[core_1.kIsNormalizedAlready] = true;\n\n      if (initHookError) {\n        throw new as_promise_1.RequestError(initHookError.message, initHookError, normalizedOptions);\n      }\n\n      return iterateHandlers(normalizedOptions);\n    } catch (error) {\n      if (options.isStream) {\n        throw error;\n      } else {\n        return create_rejection_1.default(error, defaults.options.hooks.beforeError, (_b = options.hooks) === null || _b === void 0 ? void 0 : _b.beforeError);\n      }\n    }\n  };\n\n  got.extend = (...instancesOrOptions) => {\n    const optionsArray = [defaults.options];\n    let handlers = [...defaults._rawHandlers];\n    let isMutableDefaults;\n\n    for (const value of instancesOrOptions) {\n      if (isGotInstance(value)) {\n        optionsArray.push(value.defaults.options);\n        handlers.push(...value.defaults._rawHandlers);\n        isMutableDefaults = value.defaults.mutableDefaults;\n      } else {\n        optionsArray.push(value);\n\n        if ('handlers' in value) {\n          handlers.push(...value.handlers);\n        }\n\n        isMutableDefaults = value.mutableDefaults;\n      }\n    }\n\n    handlers = handlers.filter(handler => handler !== exports.defaultHandler);\n\n    if (handlers.length === 0) {\n      handlers.push(exports.defaultHandler);\n    }\n\n    return create({\n      options: mergeOptions(...optionsArray),\n      handlers,\n      mutableDefaults: Boolean(isMutableDefaults)\n    });\n  }; // Pagination\n\n\n  const paginateEach = async function* (url, options) {\n    // TODO: Remove this `@ts-expect-error` when upgrading to TypeScript 4.\n    // Error: Argument of type 'Merge<Options, PaginationOptions<T, R>> | undefined' is not assignable to parameter of type 'Options | undefined'.\n    // @ts-expect-error\n    let normalizedOptions = normalizeArguments(url, options, defaults.options);\n    normalizedOptions.resolveBodyOnly = false;\n    const pagination = normalizedOptions.pagination;\n\n    if (!is_1.default.object(pagination)) {\n      throw new TypeError('`options.pagination` must be implemented');\n    }\n\n    const all = [];\n    let {\n      countLimit\n    } = pagination;\n    let numberOfRequests = 0;\n\n    while (numberOfRequests < pagination.requestLimit) {\n      if (numberOfRequests !== 0) {\n        // eslint-disable-next-line no-await-in-loop\n        await delay(pagination.backoff);\n      } // @ts-expect-error FIXME!\n      // TODO: Throw when result is not an instance of Response\n      // eslint-disable-next-line no-await-in-loop\n\n\n      const result = await got(undefined, undefined, normalizedOptions); // eslint-disable-next-line no-await-in-loop\n\n      const parsed = await pagination.transform(result);\n      const current = [];\n\n      for (const item of parsed) {\n        if (pagination.filter(item, all, current)) {\n          if (!pagination.shouldContinue(item, all, current)) {\n            return;\n          }\n\n          yield item;\n\n          if (pagination.stackAllItems) {\n            all.push(item);\n          }\n\n          current.push(item);\n\n          if (--countLimit <= 0) {\n            return;\n          }\n        }\n      }\n\n      const optionsToMerge = pagination.paginate(result, all, current);\n\n      if (optionsToMerge === false) {\n        return;\n      }\n\n      if (optionsToMerge === result.request.options) {\n        normalizedOptions = result.request.options;\n      } else if (optionsToMerge !== undefined) {\n        normalizedOptions = normalizeArguments(undefined, optionsToMerge, normalizedOptions);\n      }\n\n      numberOfRequests++;\n    }\n  };\n\n  got.paginate = paginateEach;\n\n  got.paginate.all = async (url, options) => {\n    const results = [];\n\n    for await (const item of paginateEach(url, options)) {\n      results.push(item);\n    }\n\n    return results;\n  }; // For those who like very descriptive names\n\n\n  got.paginate.each = paginateEach; // Stream API\n\n  got.stream = (url, options) => got(url, { ...options,\n    isStream: true\n  }); // Shortcuts\n\n\n  for (const method of aliases) {\n    got[method] = (url, options) => got(url, { ...options,\n      method\n    });\n\n    got.stream[method] = (url, options) => {\n      return got(url, { ...options,\n        method,\n        isStream: true\n      });\n    };\n  }\n\n  Object.assign(got, errors);\n  Object.defineProperty(got, 'defaults', {\n    value: defaults.mutableDefaults ? defaults : deep_freeze_1.default(defaults),\n    writable: defaults.mutableDefaults,\n    configurable: defaults.mutableDefaults,\n    enumerable: true\n  });\n  got.mergeOptions = mergeOptions;\n  return got;\n};\n\nexports.default = create;\n\n__exportStar(require(\"./types\"), exports);","map":{"version":3,"sources":["/home/td/code/up-frontend-mvp/node_modules/got/dist/source/create.js"],"names":["__createBinding","Object","create","o","m","k","k2","undefined","defineProperty","enumerable","get","__exportStar","exports","p","prototype","hasOwnProperty","call","value","defaultHandler","is_1","require","as_promise_1","create_rejection_1","core_1","deep_freeze_1","errors","RequestError","CacheError","ReadError","HTTPError","MaxRedirectsError","TimeoutError","ParseError","CancelError","UnsupportedProtocolError","UploadError","delay","ms","Promise","resolve","setTimeout","normalizeArguments","default","mergeOptions","sources","mergedOptions","source","getPromiseOrStream","options","isStream","isGotInstance","defaults","aliases","next","callInitHooks","hooks","hook","_rawHandlers","handlers","map","fn","root","result","newOptions","typedResult","then","promiseThen","catch","promiseCatch","finally","promiseFianlly","setPrototypeOf","getPrototypeOf","defineProperties","getOwnPropertyDescriptors","got","url","_defaults","_a","_b","iteration","iterateHandlers","length","plainObject","setNonEnumerableProperties","initHookError","init","error","normalizedOptions","kIsNormalizedAlready","message","beforeError","extend","instancesOrOptions","optionsArray","isMutableDefaults","push","mutableDefaults","filter","handler","Boolean","paginateEach","resolveBodyOnly","pagination","object","TypeError","all","countLimit","numberOfRequests","requestLimit","backoff","parsed","transform","current","item","shouldContinue","stackAllItems","optionsToMerge","paginate","request","results","each","stream","method","assign","writable","configurable"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.defaultHandler = void 0;\nconst is_1 = require(\"@sindresorhus/is\");\nconst as_promise_1 = require(\"./as-promise\");\nconst create_rejection_1 = require(\"./as-promise/create-rejection\");\nconst core_1 = require(\"./core\");\nconst deep_freeze_1 = require(\"./utils/deep-freeze\");\nconst errors = {\n    RequestError: as_promise_1.RequestError,\n    CacheError: as_promise_1.CacheError,\n    ReadError: as_promise_1.ReadError,\n    HTTPError: as_promise_1.HTTPError,\n    MaxRedirectsError: as_promise_1.MaxRedirectsError,\n    TimeoutError: as_promise_1.TimeoutError,\n    ParseError: as_promise_1.ParseError,\n    CancelError: as_promise_1.CancelError,\n    UnsupportedProtocolError: as_promise_1.UnsupportedProtocolError,\n    UploadError: as_promise_1.UploadError\n};\n// The `delay` package weighs 10KB (!)\nconst delay = async (ms) => new Promise(resolve => {\n    setTimeout(resolve, ms);\n});\nconst { normalizeArguments } = core_1.default;\nconst mergeOptions = (...sources) => {\n    let mergedOptions;\n    for (const source of sources) {\n        mergedOptions = normalizeArguments(undefined, source, mergedOptions);\n    }\n    return mergedOptions;\n};\nconst getPromiseOrStream = (options) => options.isStream ? new core_1.default(undefined, options) : as_promise_1.default(options);\nconst isGotInstance = (value) => ('defaults' in value && 'options' in value.defaults);\nconst aliases = [\n    'get',\n    'post',\n    'put',\n    'patch',\n    'head',\n    'delete'\n];\nexports.defaultHandler = (options, next) => next(options);\nconst callInitHooks = (hooks, options) => {\n    if (hooks) {\n        for (const hook of hooks) {\n            hook(options);\n        }\n    }\n};\nconst create = (defaults) => {\n    // Proxy properties from next handlers\n    defaults._rawHandlers = defaults.handlers;\n    defaults.handlers = defaults.handlers.map(fn => ((options, next) => {\n        // This will be assigned by assigning result\n        let root;\n        const result = fn(options, newOptions => {\n            root = next(newOptions);\n            return root;\n        });\n        if (result !== root && !options.isStream && root) {\n            const typedResult = result;\n            const { then: promiseThen, catch: promiseCatch, finally: promiseFianlly } = typedResult;\n            Object.setPrototypeOf(typedResult, Object.getPrototypeOf(root));\n            Object.defineProperties(typedResult, Object.getOwnPropertyDescriptors(root));\n            // These should point to the new promise\n            // eslint-disable-next-line promise/prefer-await-to-then\n            typedResult.then = promiseThen;\n            typedResult.catch = promiseCatch;\n            typedResult.finally = promiseFianlly;\n        }\n        return result;\n    }));\n    // Got interface\n    const got = ((url, options = {}, _defaults) => {\n        var _a, _b;\n        let iteration = 0;\n        const iterateHandlers = (newOptions) => {\n            return defaults.handlers[iteration++](newOptions, iteration === defaults.handlers.length ? getPromiseOrStream : iterateHandlers);\n        };\n        // TODO: Remove this in Got 12.\n        if (is_1.default.plainObject(url)) {\n            const mergedOptions = {\n                ...url,\n                ...options\n            };\n            core_1.setNonEnumerableProperties([url, options], mergedOptions);\n            options = mergedOptions;\n            url = undefined;\n        }\n        try {\n            // Call `init` hooks\n            let initHookError;\n            try {\n                callInitHooks(defaults.options.hooks.init, options);\n                callInitHooks((_a = options.hooks) === null || _a === void 0 ? void 0 : _a.init, options);\n            }\n            catch (error) {\n                initHookError = error;\n            }\n            // Normalize options & call handlers\n            const normalizedOptions = normalizeArguments(url, options, _defaults !== null && _defaults !== void 0 ? _defaults : defaults.options);\n            normalizedOptions[core_1.kIsNormalizedAlready] = true;\n            if (initHookError) {\n                throw new as_promise_1.RequestError(initHookError.message, initHookError, normalizedOptions);\n            }\n            return iterateHandlers(normalizedOptions);\n        }\n        catch (error) {\n            if (options.isStream) {\n                throw error;\n            }\n            else {\n                return create_rejection_1.default(error, defaults.options.hooks.beforeError, (_b = options.hooks) === null || _b === void 0 ? void 0 : _b.beforeError);\n            }\n        }\n    });\n    got.extend = (...instancesOrOptions) => {\n        const optionsArray = [defaults.options];\n        let handlers = [...defaults._rawHandlers];\n        let isMutableDefaults;\n        for (const value of instancesOrOptions) {\n            if (isGotInstance(value)) {\n                optionsArray.push(value.defaults.options);\n                handlers.push(...value.defaults._rawHandlers);\n                isMutableDefaults = value.defaults.mutableDefaults;\n            }\n            else {\n                optionsArray.push(value);\n                if ('handlers' in value) {\n                    handlers.push(...value.handlers);\n                }\n                isMutableDefaults = value.mutableDefaults;\n            }\n        }\n        handlers = handlers.filter(handler => handler !== exports.defaultHandler);\n        if (handlers.length === 0) {\n            handlers.push(exports.defaultHandler);\n        }\n        return create({\n            options: mergeOptions(...optionsArray),\n            handlers,\n            mutableDefaults: Boolean(isMutableDefaults)\n        });\n    };\n    // Pagination\n    const paginateEach = (async function* (url, options) {\n        // TODO: Remove this `@ts-expect-error` when upgrading to TypeScript 4.\n        // Error: Argument of type 'Merge<Options, PaginationOptions<T, R>> | undefined' is not assignable to parameter of type 'Options | undefined'.\n        // @ts-expect-error\n        let normalizedOptions = normalizeArguments(url, options, defaults.options);\n        normalizedOptions.resolveBodyOnly = false;\n        const pagination = normalizedOptions.pagination;\n        if (!is_1.default.object(pagination)) {\n            throw new TypeError('`options.pagination` must be implemented');\n        }\n        const all = [];\n        let { countLimit } = pagination;\n        let numberOfRequests = 0;\n        while (numberOfRequests < pagination.requestLimit) {\n            if (numberOfRequests !== 0) {\n                // eslint-disable-next-line no-await-in-loop\n                await delay(pagination.backoff);\n            }\n            // @ts-expect-error FIXME!\n            // TODO: Throw when result is not an instance of Response\n            // eslint-disable-next-line no-await-in-loop\n            const result = (await got(undefined, undefined, normalizedOptions));\n            // eslint-disable-next-line no-await-in-loop\n            const parsed = await pagination.transform(result);\n            const current = [];\n            for (const item of parsed) {\n                if (pagination.filter(item, all, current)) {\n                    if (!pagination.shouldContinue(item, all, current)) {\n                        return;\n                    }\n                    yield item;\n                    if (pagination.stackAllItems) {\n                        all.push(item);\n                    }\n                    current.push(item);\n                    if (--countLimit <= 0) {\n                        return;\n                    }\n                }\n            }\n            const optionsToMerge = pagination.paginate(result, all, current);\n            if (optionsToMerge === false) {\n                return;\n            }\n            if (optionsToMerge === result.request.options) {\n                normalizedOptions = result.request.options;\n            }\n            else if (optionsToMerge !== undefined) {\n                normalizedOptions = normalizeArguments(undefined, optionsToMerge, normalizedOptions);\n            }\n            numberOfRequests++;\n        }\n    });\n    got.paginate = paginateEach;\n    got.paginate.all = (async (url, options) => {\n        const results = [];\n        for await (const item of paginateEach(url, options)) {\n            results.push(item);\n        }\n        return results;\n    });\n    // For those who like very descriptive names\n    got.paginate.each = paginateEach;\n    // Stream API\n    got.stream = ((url, options) => got(url, { ...options, isStream: true }));\n    // Shortcuts\n    for (const method of aliases) {\n        got[method] = ((url, options) => got(url, { ...options, method }));\n        got.stream[method] = ((url, options) => {\n            return got(url, { ...options, method, isStream: true });\n        });\n    }\n    Object.assign(got, errors);\n    Object.defineProperty(got, 'defaults', {\n        value: defaults.mutableDefaults ? defaults : deep_freeze_1.default(defaults),\n        writable: defaults.mutableDefaults,\n        configurable: defaults.mutableDefaults,\n        enumerable: true\n    });\n    got.mergeOptions = mergeOptions;\n    return got;\n};\nexports.default = create;\n__exportStar(require(\"./types\"), exports);\n"]},"metadata":{},"sourceType":"script"}