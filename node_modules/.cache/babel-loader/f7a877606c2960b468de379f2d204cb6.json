{"ast":null,"code":"'use strict';\n\nclass CancelError extends Error {\n  constructor(reason) {\n    super(reason || 'Promise was canceled');\n    this.name = 'CancelError';\n  }\n\n  get isCanceled() {\n    return true;\n  }\n\n}\n\nclass PCancelable {\n  static fn(userFn) {\n    return (...arguments_) => {\n      return new PCancelable((resolve, reject, onCancel) => {\n        arguments_.push(onCancel); // eslint-disable-next-line promise/prefer-await-to-then\n\n        userFn(...arguments_).then(resolve, reject);\n      });\n    };\n  }\n\n  constructor(executor) {\n    this._cancelHandlers = [];\n    this._isPending = true;\n    this._isCanceled = false;\n    this._rejectOnCancel = true;\n    this._promise = new Promise((resolve, reject) => {\n      this._reject = reject;\n\n      const onResolve = value => {\n        if (!this._isCanceled || !onCancel.shouldReject) {\n          this._isPending = false;\n          resolve(value);\n        }\n      };\n\n      const onReject = error => {\n        this._isPending = false;\n        reject(error);\n      };\n\n      const onCancel = handler => {\n        if (!this._isPending) {\n          throw new Error('The `onCancel` handler was attached after the promise settled.');\n        }\n\n        this._cancelHandlers.push(handler);\n      };\n\n      Object.defineProperties(onCancel, {\n        shouldReject: {\n          get: () => this._rejectOnCancel,\n          set: boolean => {\n            this._rejectOnCancel = boolean;\n          }\n        }\n      });\n      return executor(onResolve, onReject, onCancel);\n    });\n  }\n\n  then(onFulfilled, onRejected) {\n    // eslint-disable-next-line promise/prefer-await-to-then\n    return this._promise.then(onFulfilled, onRejected);\n  }\n\n  catch(onRejected) {\n    return this._promise.catch(onRejected);\n  }\n\n  finally(onFinally) {\n    return this._promise.finally(onFinally);\n  }\n\n  cancel(reason) {\n    if (!this._isPending || this._isCanceled) {\n      return;\n    }\n\n    this._isCanceled = true;\n\n    if (this._cancelHandlers.length > 0) {\n      try {\n        for (const handler of this._cancelHandlers) {\n          handler();\n        }\n      } catch (error) {\n        this._reject(error);\n\n        return;\n      }\n    }\n\n    if (this._rejectOnCancel) {\n      this._reject(new CancelError(reason));\n    }\n  }\n\n  get isCanceled() {\n    return this._isCanceled;\n  }\n\n}\n\nObject.setPrototypeOf(PCancelable.prototype, Promise.prototype);\nmodule.exports = PCancelable;\nmodule.exports.CancelError = CancelError;","map":{"version":3,"sources":["/home/td/code/up-frontend-mvp/node_modules/p-cancelable/index.js"],"names":["CancelError","Error","constructor","reason","name","isCanceled","PCancelable","fn","userFn","arguments_","resolve","reject","onCancel","push","then","executor","_cancelHandlers","_isPending","_isCanceled","_rejectOnCancel","_promise","Promise","_reject","onResolve","value","shouldReject","onReject","error","handler","Object","defineProperties","get","set","boolean","onFulfilled","onRejected","catch","finally","onFinally","cancel","length","setPrototypeOf","prototype","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nclass CancelError extends Error {\n\tconstructor(reason) {\n\t\tsuper(reason || 'Promise was canceled');\n\t\tthis.name = 'CancelError';\n\t}\n\n\tget isCanceled() {\n\t\treturn true;\n\t}\n}\n\nclass PCancelable {\n\tstatic fn(userFn) {\n\t\treturn (...arguments_) => {\n\t\t\treturn new PCancelable((resolve, reject, onCancel) => {\n\t\t\t\targuments_.push(onCancel);\n\t\t\t\t// eslint-disable-next-line promise/prefer-await-to-then\n\t\t\t\tuserFn(...arguments_).then(resolve, reject);\n\t\t\t});\n\t\t};\n\t}\n\n\tconstructor(executor) {\n\t\tthis._cancelHandlers = [];\n\t\tthis._isPending = true;\n\t\tthis._isCanceled = false;\n\t\tthis._rejectOnCancel = true;\n\n\t\tthis._promise = new Promise((resolve, reject) => {\n\t\t\tthis._reject = reject;\n\n\t\t\tconst onResolve = value => {\n\t\t\t\tif (!this._isCanceled || !onCancel.shouldReject) {\n\t\t\t\t\tthis._isPending = false;\n\t\t\t\t\tresolve(value);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tconst onReject = error => {\n\t\t\t\tthis._isPending = false;\n\t\t\t\treject(error);\n\t\t\t};\n\n\t\t\tconst onCancel = handler => {\n\t\t\t\tif (!this._isPending) {\n\t\t\t\t\tthrow new Error('The `onCancel` handler was attached after the promise settled.');\n\t\t\t\t}\n\n\t\t\t\tthis._cancelHandlers.push(handler);\n\t\t\t};\n\n\t\t\tObject.defineProperties(onCancel, {\n\t\t\t\tshouldReject: {\n\t\t\t\t\tget: () => this._rejectOnCancel,\n\t\t\t\t\tset: boolean => {\n\t\t\t\t\t\tthis._rejectOnCancel = boolean;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn executor(onResolve, onReject, onCancel);\n\t\t});\n\t}\n\n\tthen(onFulfilled, onRejected) {\n\t\t// eslint-disable-next-line promise/prefer-await-to-then\n\t\treturn this._promise.then(onFulfilled, onRejected);\n\t}\n\n\tcatch(onRejected) {\n\t\treturn this._promise.catch(onRejected);\n\t}\n\n\tfinally(onFinally) {\n\t\treturn this._promise.finally(onFinally);\n\t}\n\n\tcancel(reason) {\n\t\tif (!this._isPending || this._isCanceled) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isCanceled = true;\n\n\t\tif (this._cancelHandlers.length > 0) {\n\t\t\ttry {\n\t\t\t\tfor (const handler of this._cancelHandlers) {\n\t\t\t\t\thandler();\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tthis._reject(error);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (this._rejectOnCancel) {\n\t\t\tthis._reject(new CancelError(reason));\n\t\t}\n\t}\n\n\tget isCanceled() {\n\t\treturn this._isCanceled;\n\t}\n}\n\nObject.setPrototypeOf(PCancelable.prototype, Promise.prototype);\n\nmodule.exports = PCancelable;\nmodule.exports.CancelError = CancelError;\n"]},"metadata":{},"sourceType":"script"}